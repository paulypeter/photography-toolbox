<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<header>
    <nav>
    <div class=nav>
        <a><i class="fa fa-bars menu" aria-hidden="true"></i></a>
        <div class=menu></div>
        <a href="index.html"><i class="fa fa-camera menu"> Photography Toolbox</i></a>
    </div>
    </nav>
</header>
<link rel=stylesheet href=static/style.css type=text/css>
<script src="src/crop-factor.js"></script>
<script src="src/exposure.js"></script>
<script src="js/Tools.js"></script>

<script src="https://use.fontawesome.com/f35383e121.js"></script>

<title>Depth of Field | Photography Toolbox</title>

<div class=form-container>
    <div class=row>
        <label for="sensor">Sensor format</label>
        <select id="sensor" onchange="update_result()"></select>
    </div>
    <div class=row>
        <label for=focal_length>Focal length</label>
        <input type="number" id=focal_length onchange="update_result()" value=50>
    </div>
    <div class=row>
        <label for="f_stop">F-stop</label>
        <select id="f_stop" onchange="update_result()"></select>
    </div>
    <div class=row>
        <div class=column><label for=distance>Distance: </label></div>
        <input type="range" id=distance onchange="update_input(); update_result()" min=1>
        <div class=column><span id=input class=input></span></div>
        <select id="distance_unit" onchange="update_result()">
            <option value=10>cm</option>
            <option value=100 selected>dm</option>
            <option value=1000>m</option>
        </select>
    </div>
</div>
<div class=form-container>
    <div class=row>
        <div class=column>Hyperfocal distance <span id=hyperfocal_dist></span> m</div><br>
    </div>
</div>
<div class=form-container>
    <div class=row>
        <div class=column>Near limit <span id=near_limit></span> m</div>
    </div>
    <div class=row>
        <div class=column>Far limit <span id=far_limit></span> m</div>
    </div>
</div>

<script>
    sensors_size_select("sensor")
    speed_select("f_stop", F_STOPS.reverse())
    update_input = () => {
        document.getElementById("input").innerHTML = document.getElementById("distance").value
    }
    update_result = () => {
        let focal_length = document.getElementById("focal_length").value
        let sensor_size = JSON.parse(document.getElementById("sensor").value)
        let f_stop = parseFloat(document.getElementById("f_stop").value)
        let distance = (
            parseInt(document.getElementById("distance").value) *
            parseInt(document.getElementById("distance_unit").value)
        )
        dof_far_result = dof_far(sensor_size, distance, focal_length, f_stop)
        dof_far_result = dof_far_result < 0 ? Infinity : dof_far_result
        dof_near_result = dof_near(sensor_size, distance, focal_length, f_stop)
        hyperfocal_dist = Number((hyperfocal(focal_length, f_stop, sensor_size) / 1000).toFixed(2))
        document.getElementById("near_limit").innerHTML = dof_near_result
        document.getElementById("far_limit").innerHTML = dof_far_result
        document.getElementById("hyperfocal_dist").innerHTML = hyperfocal_dist
    }

    window.onload = () => {
        update_input()
    }
</script>