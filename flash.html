<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<header>
    <nav>
    <div class=nav>
        <a><i class="fa fa-bars menu" aria-hidden="true"></i></a>
        <div class=menu></div>
        <a href="index.html"><i class="fa fa-camera menu" id=title> Photography Toolbox</i></a>
        <a href="docs/calculations.html" class=helplink><i class="fa fa-question menu"></i></a>
    </div>
    </nav>
</header>
<link rel=stylesheet href=static/style.css type=text/css>
<script src="src/crop-factor.js"></script>
<script src="src/exposure.js"></script>
<script src="js/Tools.js"></script>
<script src="src/flash.js"></script>

<script src="https://use.fontawesome.com/f35383e121.js"></script>

<title>Flash | Photography Toolbox</title>

<div class=form-container>
    <div class=row>
        <div class=column>Calculate:</div>
        <div onchange="toggle_input(); update_result()" class=row>
            <input type="radio" name=setting_choice id=get_guide_number value="guide_number">
            <label for=get_guide_number>Guide Number</label>
            <input type="radio" name=setting_choice id=get_f_stop value="f_stop" checked>
            <label for=get_f_stop>F-Stop</label>
            <input type="radio" name=setting_choice id=get_distance value="distance">
            <label for=get_distance>Distance</label>
        </div>
    </div>
</div>
<div class=form-container>
    <div class=row>
        <div class=column><label for="iso_speed">ISO</label></div>
        <div class=column><select id="iso_speed" onchange="update_result()"></select></div>
    </div>
    <div class=row id="guide_number_input">
        <div class=column><label for="guide_number">Guide Number</label></div>
        <div class=column><input type=number id="guide_number" onchange="update_result()" value=43></div>
    </div>
    <div class=row id="f_stop_input">
        <div class=column><label for="f_stop">F-stop</label></div>
        <div class=column><select id="f_stop" onchange="update_result()"></select></div>
    </div>
    <div class=row id="distance_input">
        <div class=column><label for="distance">Distance</label></div>
        <div class=column><input type=number id="distance" onchange="update_result()" value=10></div>
    </div>
</div>
<div class=form-container>
    <div class=row>
        <div class=column>result:</div><div class=column><span id=result></span><span id=result_unit></span></div>
    </div>
</div>

<script>
    speed_select("f_stop", F_STOPS.reverse())
    speed_select("iso_speed", ISO_SPEEDS)

    let mode = ""
    toggle_input = () => {
        let options = document.getElementsByName("setting_choice")
        options.forEach(element => {
            if (element.checked) {
                mode = element.value
                document.getElementById(element.value + "_input").style.display = "none"
            } else {
                document.getElementById(element.value + "_input").style.display = "inline-block"
            }
        });
    }

    get_input = () => {
        let settings = ["distance", "guide_number", "f_stop", "iso_speed"]
        let input = {}
        settings.forEach(element => {
            input[element] = document.getElementById(element).value
        })
        return input
    }

    get_result = () => {
        let input = get_input()
        switch(mode) {
            case "f_stop":
                return flash_f_stop(input.guide_number, input.distance, input.iso_speed)
            case "distance":
                return flash_max_distance(input.guide_number, input.f_stop, input.iso_speed)
            case "guide_number":
                return guide_number(input.distance, input.f_stop, input.iso_speed)
        }
    }

    update_result = () => {
        document.getElementById("result").innerHTML = get_result()
        document.getElementById("result_unit").innerHTML = mode == "distance" ? " m" : ""
    }

    window.onload = () => {
        toggle_input()
        let window_width = window.innerWidth;
        if (window_width < 340) {
            document.getElementById("title").innerHTML = " Photo Tools"
        }
    }
</script>